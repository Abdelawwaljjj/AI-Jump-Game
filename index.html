<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Jump - Realistic Lava and Explosion</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            background-color: #000;
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* Lava animation */
        @keyframes lavaFlow {
            0% { background-position: 0 0; }
            100% { background-position: -200px 0; }
        }

        /* Glow effect */
        .lava-glow {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100px;
            background: radial-gradient(circle, rgba(255,69,0,0.8), transparent);
            opacity: 0.6;
            pointer-events: none;
            animation: glowPulse 2s ease-in-out infinite;
        }

        @keyframes glowPulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 0.9; }
        }
    </style>
</head>

<body>
    <canvas id="gameCanvas"></canvas>

    <div class="lava-glow"></div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // Lava Texture
        const lavaTexture = new Image();
        lavaTexture.src = 'lava-texture.png';

        // Particle Systems
        const explosionParticles = [];
        const smokeParticles = [];
        const particleCount = 100;
        const particleLife = 100;

        function createExplosionParticles(x, y) {
            for (let i = 0; i < particleCount; i++) {
                explosionParticles.push({
                    x,
                    y,
                    vx: (Math.random() - 0.5) * 8,
                    vy: (Math.random() - 0.5) * 8,
                    life: particleLife,
                    color: `rgba(255, ${Math.floor(Math.random() * 200)}, 0, 1)`
                });
            }
        }

        function createSmokeParticles(x, y) {
            for (let i = 0; i < 50; i++) {
                smokeParticles.push({
                    x,
                    y,
                    vx: (Math.random() - 0.5) * 2,
                    vy: -Math.random() * 2 - 1,
                    life: 200,
                    size: Math.random() * 20 + 10,
                    opacity: 1
                });
            }
        }

        function drawParticles(particles) {
            particles.forEach((p, i) => {
                if (p.life > 0) {
                    ctx.fillStyle = p.color || `rgba(100, 100, 100, ${p.opacity})`;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size || 5, 0, Math.PI * 2);
                    ctx.fill();

                    p.x += p.vx;
                    p.y += p.vy;
                    p.life--;
                    p.opacity -= 0.005; // Fade out smoke particles

                    if (p.life <= 0 || p.opacity <= 0) {
                        particles.splice(i, 1);
                    }
                }
            });
        }

        // Example Explosion Trigger
        function triggerExplosion(x, y) {
            createExplosionParticles(x, y);
            createSmokeParticles(x, y);
            drawExplosionLight(x, y);
            playExplosionSound();
        }

        // Explosion Light
        function drawExplosionLight(x, y) {
            ctx.save();
            ctx.globalCompositeOperation = 'lighter';
            ctx.fillStyle = 'rgba(255, 140, 0, 0.8)';
            ctx.beginPath();
            ctx.arc(x, y, 100, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
        }

        // Explosion Sound
        function playExplosionSound() {
            const explosionSound = new Audio('explosion-sound.mp3');
            explosionSound.play();
        }

        // Lava Overflow
        let lavaOverflowSpeed = 0;
        function increaseLavaOverflow() {
            lavaOverflowSpeed += 0.1;
        }

        function drawLava() {
            const tileWidth = lavaTexture.width;
            const tileHeight = lavaTexture.height;
            const numTiles = Math.ceil(canvas.width / tileWidth) + 1;

            ctx.save();
            ctx.translate(0, canvas.height - 100 + lavaOverflowSpeed);
            ctx.globalAlpha = 0.9;
            ctx.beginPath();
            for (let i = 0; i < numTiles; i++) {
                ctx.drawImage(lavaTexture, i * tileWidth, 0, tileWidth, tileHeight);
            }
            ctx.restore();
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawLava();
            drawParticles(explosionParticles);
            drawParticles(smokeParticles);
            requestAnimationFrame(draw);
        }

        canvas.addEventListener('click', (event) => {
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            triggerExplosion(x, y);
            increaseLavaOverflow();
        });

        draw();
    </script>
</body>

</html>

</html>
